# BEGIN GraphQL Rule (Ensures WordPress Handles It)
<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteRule ^graphql/?$ /index.php [L]
</IfModule>
# END GraphQL Rule

# BEGIN Nuxt Rule
<IfModule mod_rewrite.c>
  RewriteEngine On

  # Serve frontend index.html at the root ("/")
  RewriteRule ^$ /frontend/index.html [L]

  # Exclude WordPress paths from Nuxt handling
  RewriteCond %{REQUEST_URI} !^/wp-admin
  RewriteCond %{REQUEST_URI} !^/wp-login.php
  RewriteCond %{REQUEST_URI} !^/wp-json
  RewriteCond %{REQUEST_URI} !^/wp-includes

  # Serve static resources (JS, CSS, images) from /frontend/_nuxt and /frontend
  RewriteCond %{REQUEST_URI} \.(css|js|jpg|jpeg|png|gif|svg|woff|woff2|eot|ttf|otf|json)$ [NC]

  # Handle requests for dynamic JS chunks and assets under /frontend/_nuxt
  RewriteRule ^_nuxt/(.*)$ /frontend/_nuxt/$1 [L]

  # Serve other static resources from /frontend/
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteRule ^(.*)$ /frontend/$1 [L]
</IfModule>
# END Nuxt Rule

# BEGIN WordPress
<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]
  RewriteBase /
  RewriteRule ^index\.php$ - [L]
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteRule . /index.php [L]
</IfModule>
# END WordPress

# BEGIN ShortPixelWebp
# ShortPixelWebp optimizations should remain untouched
# This section is dynamically generated by the plugin

# END ShortPixelWebp
